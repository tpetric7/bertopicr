<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Train a BERTopic Model — train_bertopic_model • bertopicr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Train a BERTopic Model — train_bertopic_model"><meta name="description" content="This function creates embeddings with sentence-transformers, configures UMAP,
HDBSCAN, and CountVectorizer, optionally wires a representation model, and fits
a BERTopic model from R. The returned model can be used with bertopicr helpers."><meta property="og:description" content="This function creates embeddings with sentence-transformers, configures UMAP,
HDBSCAN, and CountVectorizer, optionally wires a representation model, and fits
a BERTopic model from R. The returned model can be used with bertopicr helpers."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bertopicr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/load_and_reuse_model.html">Load and Reuse a BERTopic Model</a></li>
    <li><a class="dropdown-item" href="../articles/topics_spiegel.html">Topic Modeling with BERTopic in R using reticulate and local LLMs</a></li>
    <li><a class="dropdown-item" href="../articles/train_and_save_model.html">Train and Save a BERTopic Model</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Train a BERTopic Model</h1>

      <div class="d-none name"><code>train_bertopic_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates embeddings with sentence-transformers, configures UMAP,
HDBSCAN, and CountVectorizer, optionally wires a representation model, and fits
a BERTopic model from R. The returned model can be used with bertopicr helpers.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">train_bertopic_model</span><span class="op">(</span></span>
<span>  <span class="va">docs</span>,</span>
<span>  embedding_model <span class="op">=</span> <span class="st">"Qwen/Qwen3-Embedding-0.6B"</span>,</span>
<span>  embeddings <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  embedding_batch_size <span class="op">=</span> <span class="fl">32</span>,</span>
<span>  embedding_show_progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  umap_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  umap_n_neighbors <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  umap_n_components <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  umap_min_dist <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  umap_metric <span class="op">=</span> <span class="st">"cosine"</span>,</span>
<span>  umap_random_state <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  hdbscan_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hdbscan_min_cluster_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  hdbscan_min_samples <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  hdbscan_metric <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  hdbscan_cluster_selection_method <span class="op">=</span> <span class="st">"eom"</span>,</span>
<span>  hdbscan_gen_min_span_tree <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  hdbscan_prediction_data <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  hdbscan_core_dist_n_jobs <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  vectorizer_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stop_words <span class="op">=</span> <span class="st">"all_stopwords"</span>,</span>
<span>  ngram_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  min_df <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  max_df <span class="op">=</span> <span class="fl">50L</span>,</span>
<span>  max_features <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  strip_accents <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  decode_error <span class="op">=</span> <span class="st">"strict"</span>,</span>
<span>  encoding <span class="op">=</span> <span class="st">"UTF-8"</span>,</span>
<span>  representation_model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"keybert"</span>, <span class="st">"mmr"</span>, <span class="st">"ollama"</span><span class="op">)</span>,</span>
<span>  representation_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  ollama_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ollama_base_url <span class="op">=</span> <span class="st">"http://localhost:11434/v1"</span>,</span>
<span>  ollama_api_key <span class="op">=</span> <span class="st">"ollama"</span>,</span>
<span>  ollama_client_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  ollama_prompt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top_n_words <span class="op">=</span> <span class="fl">200L</span>,</span>
<span>  calculate_probabilities <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  timestamps <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  topics_over_time_nr_bins <span class="op">=</span> <span class="fl">20L</span>,</span>
<span>  topics_over_time_global_tuning <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  topics_over_time_evolution_tuning <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  classes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  compute_reduced_embeddings <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  reduced_embedding_n_neighbors <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  reduced_embedding_min_dist <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  reduced_embedding_metric <span class="op">=</span> <span class="st">"cosine"</span>,</span>
<span>  compute_hierarchical_topics <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bertopic_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-docs">docs<a class="anchor" aria-label="anchor" href="#arg-docs"></a></dt>
<dd><p>Character vector of documents to model.</p></dd>


<dt id="arg-embedding-model">embedding_model<a class="anchor" aria-label="anchor" href="#arg-embedding-model"></a></dt>
<dd><p>Sentence-transformers model name or local path.</p></dd>


<dt id="arg-embeddings">embeddings<a class="anchor" aria-label="anchor" href="#arg-embeddings"></a></dt>
<dd><p>Optional precomputed embeddings (matrix or array).</p></dd>


<dt id="arg-embedding-batch-size">embedding_batch_size<a class="anchor" aria-label="anchor" href="#arg-embedding-batch-size"></a></dt>
<dd><p>Batch size for embedding encoding.</p></dd>


<dt id="arg-embedding-show-progress">embedding_show_progress<a class="anchor" aria-label="anchor" href="#arg-embedding-show-progress"></a></dt>
<dd><p>Logical. Show embedding progress bar.</p></dd>


<dt id="arg-umap-model">umap_model<a class="anchor" aria-label="anchor" href="#arg-umap-model"></a></dt>
<dd><p>Optional pre-built UMAP Python object. If NULL, one is created.</p></dd>


<dt id="arg-umap-n-neighbors">umap_n_neighbors<a class="anchor" aria-label="anchor" href="#arg-umap-n-neighbors"></a></dt>
<dd><p>Number of neighbors for UMAP.</p></dd>


<dt id="arg-umap-n-components">umap_n_components<a class="anchor" aria-label="anchor" href="#arg-umap-n-components"></a></dt>
<dd><p>Number of UMAP components.</p></dd>


<dt id="arg-umap-min-dist">umap_min_dist<a class="anchor" aria-label="anchor" href="#arg-umap-min-dist"></a></dt>
<dd><p>UMAP min_dist parameter.</p></dd>


<dt id="arg-umap-metric">umap_metric<a class="anchor" aria-label="anchor" href="#arg-umap-metric"></a></dt>
<dd><p>UMAP metric.</p></dd>


<dt id="arg-umap-random-state">umap_random_state<a class="anchor" aria-label="anchor" href="#arg-umap-random-state"></a></dt>
<dd><p>Random state for UMAP.</p></dd>


<dt id="arg-hdbscan-model">hdbscan_model<a class="anchor" aria-label="anchor" href="#arg-hdbscan-model"></a></dt>
<dd><p>Optional pre-built HDBSCAN Python object. If NULL, one is created.</p></dd>


<dt id="arg-hdbscan-min-cluster-size">hdbscan_min_cluster_size<a class="anchor" aria-label="anchor" href="#arg-hdbscan-min-cluster-size"></a></dt>
<dd><p>HDBSCAN min_cluster_size.</p></dd>


<dt id="arg-hdbscan-min-samples">hdbscan_min_samples<a class="anchor" aria-label="anchor" href="#arg-hdbscan-min-samples"></a></dt>
<dd><p>HDBSCAN min_samples.</p></dd>


<dt id="arg-hdbscan-metric">hdbscan_metric<a class="anchor" aria-label="anchor" href="#arg-hdbscan-metric"></a></dt>
<dd><p>HDBSCAN metric.</p></dd>


<dt id="arg-hdbscan-cluster-selection-method">hdbscan_cluster_selection_method<a class="anchor" aria-label="anchor" href="#arg-hdbscan-cluster-selection-method"></a></dt>
<dd><p>HDBSCAN cluster selection method.</p></dd>


<dt id="arg-hdbscan-gen-min-span-tree">hdbscan_gen_min_span_tree<a class="anchor" aria-label="anchor" href="#arg-hdbscan-gen-min-span-tree"></a></dt>
<dd><p>HDBSCAN gen_min_span_tree.</p></dd>


<dt id="arg-hdbscan-prediction-data">hdbscan_prediction_data<a class="anchor" aria-label="anchor" href="#arg-hdbscan-prediction-data"></a></dt>
<dd><p>Logical. Whether to generate prediction data.</p></dd>


<dt id="arg-hdbscan-core-dist-n-jobs">hdbscan_core_dist_n_jobs<a class="anchor" aria-label="anchor" href="#arg-hdbscan-core-dist-n-jobs"></a></dt>
<dd><p>HDBSCAN core_dist_n_jobs.</p></dd>


<dt id="arg-vectorizer-model">vectorizer_model<a class="anchor" aria-label="anchor" href="#arg-vectorizer-model"></a></dt>
<dd><p>Optional pre-built CountVectorizer Python object.</p></dd>


<dt id="arg-stop-words">stop_words<a class="anchor" aria-label="anchor" href="#arg-stop-words"></a></dt>
<dd><p>Stop words for CountVectorizer. Use "all_stopwords" to load the
bundled multilingual list, "english", or a character vector.</p></dd>


<dt id="arg-ngram-range">ngram_range<a class="anchor" aria-label="anchor" href="#arg-ngram-range"></a></dt>
<dd><p>Length-2 integer vector for n-gram range.</p></dd>


<dt id="arg-min-df">min_df<a class="anchor" aria-label="anchor" href="#arg-min-df"></a></dt>
<dd><p>Minimum document frequency for CountVectorizer.</p></dd>


<dt id="arg-max-df">max_df<a class="anchor" aria-label="anchor" href="#arg-max-df"></a></dt>
<dd><p>Maximum document frequency for CountVectorizer.</p></dd>


<dt id="arg-max-features">max_features<a class="anchor" aria-label="anchor" href="#arg-max-features"></a></dt>
<dd><p>Maximum features for CountVectorizer.</p></dd>


<dt id="arg-strip-accents">strip_accents<a class="anchor" aria-label="anchor" href="#arg-strip-accents"></a></dt>
<dd><p>Passed to CountVectorizer. Use NULL to preserve umlauts.</p></dd>


<dt id="arg-decode-error">decode_error<a class="anchor" aria-label="anchor" href="#arg-decode-error"></a></dt>
<dd><p>Passed to CountVectorizer when decoding input bytes.</p></dd>


<dt id="arg-encoding">encoding<a class="anchor" aria-label="anchor" href="#arg-encoding"></a></dt>
<dd><p>Text encoding for CountVectorizer (defaults to "utf-8").</p></dd>


<dt id="arg-representation-model">representation_model<a class="anchor" aria-label="anchor" href="#arg-representation-model"></a></dt>
<dd><p>Representation model to use: "none", "keybert", "mmr", or "ollama".</p></dd>


<dt id="arg-representation-params">representation_params<a class="anchor" aria-label="anchor" href="#arg-representation-params"></a></dt>
<dd><p>Named list of parameters passed to the representation model.</p></dd>


<dt id="arg-ollama-model">ollama_model<a class="anchor" aria-label="anchor" href="#arg-ollama-model"></a></dt>
<dd><p>Ollama model name when representation_model = "ollama".</p></dd>


<dt id="arg-ollama-base-url">ollama_base_url<a class="anchor" aria-label="anchor" href="#arg-ollama-base-url"></a></dt>
<dd><p>Base URL for the Ollama OpenAI-compatible endpoint.</p></dd>


<dt id="arg-ollama-api-key">ollama_api_key<a class="anchor" aria-label="anchor" href="#arg-ollama-api-key"></a></dt>
<dd><p>API key placeholder for the Ollama OpenAI-compatible endpoint.</p></dd>


<dt id="arg-ollama-client-params">ollama_client_params<a class="anchor" aria-label="anchor" href="#arg-ollama-client-params"></a></dt>
<dd><p>Named list of extra parameters passed to openai$OpenAI().</p></dd>


<dt id="arg-ollama-prompt">ollama_prompt<a class="anchor" aria-label="anchor" href="#arg-ollama-prompt"></a></dt>
<dd><p>Optional prompt template for the Ollama OpenAI representation.</p></dd>


<dt id="arg-top-n-words">top_n_words<a class="anchor" aria-label="anchor" href="#arg-top-n-words"></a></dt>
<dd><p>Number of top words per topic to keep in the model.</p></dd>


<dt id="arg-calculate-probabilities">calculate_probabilities<a class="anchor" aria-label="anchor" href="#arg-calculate-probabilities"></a></dt>
<dd><p>Logical. Whether to calculate topic probabilities.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. Verbosity for BERTopic.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Optional random seed.</p></dd>


<dt id="arg-timestamps">timestamps<a class="anchor" aria-label="anchor" href="#arg-timestamps"></a></dt>
<dd><p>Optional vector of timestamps (Date/POSIXt/ISO strings or integer) for topics over time.
Defaults to NULL (topics over time disabled).</p></dd>


<dt id="arg-topics-over-time-nr-bins">topics_over_time_nr_bins<a class="anchor" aria-label="anchor" href="#arg-topics-over-time-nr-bins"></a></dt>
<dd><p>Number of bins for topics_over_time.</p></dd>


<dt id="arg-topics-over-time-global-tuning">topics_over_time_global_tuning<a class="anchor" aria-label="anchor" href="#arg-topics-over-time-global-tuning"></a></dt>
<dd><p>Logical. Whether to enable global tuning for topics_over_time.</p></dd>


<dt id="arg-topics-over-time-evolution-tuning">topics_over_time_evolution_tuning<a class="anchor" aria-label="anchor" href="#arg-topics-over-time-evolution-tuning"></a></dt>
<dd><p>Logical. Whether to enable evolution tuning for topics_over_time.</p></dd>


<dt id="arg-classes">classes<a class="anchor" aria-label="anchor" href="#arg-classes"></a></dt>
<dd><p>Optional vector of class labels (character or factor) for topics per class.
Defaults to NULL (topics per class disabled).</p></dd>


<dt id="arg-compute-reduced-embeddings">compute_reduced_embeddings<a class="anchor" aria-label="anchor" href="#arg-compute-reduced-embeddings"></a></dt>
<dd><p>Logical. If TRUE, computes 2D and 3D UMAP reductions.</p></dd>


<dt id="arg-reduced-embedding-n-neighbors">reduced_embedding_n_neighbors<a class="anchor" aria-label="anchor" href="#arg-reduced-embedding-n-neighbors"></a></dt>
<dd><p>Number of neighbors for reduced embeddings.</p></dd>


<dt id="arg-reduced-embedding-min-dist">reduced_embedding_min_dist<a class="anchor" aria-label="anchor" href="#arg-reduced-embedding-min-dist"></a></dt>
<dd><p>UMAP min_dist for reduced embeddings.</p></dd>


<dt id="arg-reduced-embedding-metric">reduced_embedding_metric<a class="anchor" aria-label="anchor" href="#arg-reduced-embedding-metric"></a></dt>
<dd><p>UMAP metric for reduced embeddings.</p></dd>


<dt id="arg-compute-hierarchical-topics">compute_hierarchical_topics<a class="anchor" aria-label="anchor" href="#arg-compute-hierarchical-topics"></a></dt>
<dd><p>Logical. If TRUE, computes hierarchical topics.</p></dd>


<dt id="arg-bertopic-args">bertopic_args<a class="anchor" aria-label="anchor" href="#arg-bertopic-args"></a></dt>
<dd><p>Named list of extra arguments passed to BERTopic().</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with elements model, topics, probabilities, embeddings,
reduced_embeddings_2d, reduced_embeddings_3d, hierarchical_topics,
topics_over_time, and topics_per_class.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="setup_python_environment.html">setup_python_environment</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">texts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cats are great pets"</span>, <span class="st">"Dogs are loyal companions"</span>, <span class="st">"Markets fluctuate"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">train_bertopic_model</span><span class="op">(</span><span class="va">texts</span>, embedding_model <span class="op">=</span> <span class="st">"sentence-transformers/all-MiniLM-L6-v2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="visualize_topics.html">visualize_topics</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">model</span>, filename <span class="op">=</span> <span class="st">"intertopic_distance_map"</span>, auto_open <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Teodor Petrič.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

